import{o as ae,R as s,C as ce,d as $,aM as ie,aN as q,B as le,D as ue,p as C,s as de,q as fe,t as N,v as g}from"./index-d60f2239.js";import{t as G}from"./index-d67185b0.js";const he=e=>{const{componentCls:r}=e;return{[r]:{position:"fixed",zIndex:e.zIndexPopup}}},me=e=>({zIndexPopup:e.zIndexBase+10}),pe=ae("Affix",he,me);function B(e){return e!==window?e.getBoundingClientRect():{top:0,bottom:window.innerHeight}}function X(e,r,t){if(t!==void 0&&Math.round(r.top)>Math.round(e.top)-t)return t+r.top}function W(e,r,t){if(t!==void 0&&Math.round(r.bottom)<Math.round(e.bottom)+t){const c=window.innerHeight-r.bottom;return t+c}}const K=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"];function ge(){return typeof window<"u"?window:null}const Q=0,Y=1,ve=s.forwardRef((e,r)=>{var t;const{style:c,offsetTop:p,offsetBottom:u,prefixCls:y,className:a,rootClassName:j,children:d,target:f,onChange:x}=e,{getPrefixCls:b,getTargetContainer:w}=s.useContext(ce),E=b("affix",y),[k,F]=s.useState(!1),[m,J]=s.useState(),[D,U]=s.useState(),M=s.useRef(Q),O=s.useRef(null),S=s.useRef(),v=s.useRef(null),R=s.useRef(null),h=s.useRef(null),l=(t=f??w)!==null&&t!==void 0?t:ge,A=u===void 0&&p===void 0?0:p,P=()=>{if(M.current!==Y||!R.current||!v.current||!l)return;const i=l();if(i){const o={status:Q},n=B(v.current);if(n.top===0&&n.left===0&&n.width===0&&n.height===0)return;const L=B(i),I=X(n,L,A),V=W(n,L,u);I!==void 0?(o.affixStyle={position:"fixed",top:I,width:n.width,height:n.height},o.placeholderStyle={width:n.width,height:n.height}):V!==void 0&&(o.affixStyle={position:"fixed",bottom:V,width:n.width,height:n.height},o.placeholderStyle={width:n.width,height:n.height}),o.lastAffix=!!o.affixStyle,k!==o.lastAffix&&(x==null||x(o.lastAffix)),M.current=o.status,J(o.affixStyle),U(o.placeholderStyle),F(o.lastAffix)}},_=()=>{M.current=Y,P()},T=G(()=>{_()}),z=G(()=>{if(l&&m){const i=l();if(i&&v.current){const o=B(i),n=B(v.current),L=X(n,o,A),I=W(n,o,u);if(L!==void 0&&m.top===L||I!==void 0&&m.bottom===I)return}}_()}),H=()=>{const i=l==null?void 0:l();i&&(K.forEach(o=>{var n;S.current&&((n=O.current)===null||n===void 0||n.removeEventListener(o,S.current)),i==null||i.addEventListener(o,z)}),O.current=i,S.current=z)},Z=()=>{h.current&&(clearTimeout(h.current),h.current=null);const i=l==null?void 0:l();K.forEach(o=>{var n;i==null||i.removeEventListener(o,z),S.current&&((n=O.current)===null||n===void 0||n.removeEventListener(o,S.current))}),T.cancel(),z.cancel()};s.useImperativeHandle(r,()=>({updatePosition:T})),s.useEffect(()=>(h.current=setTimeout(H),()=>Z()),[]),s.useEffect(()=>{H()},[f,m]),s.useEffect(()=>{T()},[f,p,u]);const[ee,te,ne]=pe(E),re=$(j,te,E,ne),oe=$({[re]:m});let se=ie(e,["prefixCls","offsetTop","offsetBottom","target","onChange","rootClassName"]);return ee(s.createElement(q,{onResize:T},s.createElement("div",Object.assign({style:c,className:a,ref:v},se),m&&s.createElement("div",{style:D,"aria-hidden":"true"}),s.createElement("div",{className:oe,ref:R,style:m},s.createElement(q,{onResize:T},d)))))}),Ne=ve,xe=async e=>{try{return(await ue.get(e)).data}catch(r){throw console.error("Fetch error:",r),r}},ye=()=>{const{data:e,error:r}=le("/iblog/apothegm/list",xe);return{apothegmList:e,isApothegmListFetched:!r&&e!==void 0}},we=e=>{const r=e&&e.map(d=>({categories:d.categories,_id:d._id})),t={};for(let d=0;d<r.length;d++){const f=r[d].categories;t[f]=t[f]+1||1}let c=[];const p=Object.keys(t),u=Object.values(t);let y=1;return c=p.map((d,f)=>({count:u[f],name:d,id:y++})),c.length},Se=e=>{const r=e&&e.map(a=>a.tags),t=[];for(let a=0;a<r.length;a++)t.push(...r[a]);const c=[];for(let a=0;a<t.length;a++)c.indexOf(t[a])===-1&&c.push(t[a]);let p=0;return c.map(a=>({name:a,id:p++})).length},be=()=>{const[e,r]=C.useState(!1),t=de(),{articleAllList:c,isArticleAllListFetched:p}=fe(1,1),[u,y]=C.useState([]),a=p&&c&&c.data?c.data.data:"",j=a.length,d=we(a),f=Se(a),{apothegmList:x,isApothegmListFetched:b}=ye(),[w,E]=C.useState(0),[k,F]=C.useState(""),m=b&&x&&x.data?x.data.data:"",J=m&&m.filter(v=>v.checked===!0).sort(()=>Math.random()-.5);return C.useEffect(()=>{b&&y(J)},[b]),C.useEffect(()=>{if(u.length>0){const R=u[w].content;let h="",l=0,A=!1;const P=setInterval(()=>{A||(h+=R[l],F(h),l++,l>=R.length&&(clearInterval(P),setTimeout(()=>{A=!0;const _=setInterval(()=>{h=h.slice(0,-1),F(h),h.length===0&&(clearInterval(_),A=!1,w+1<u.length?E(w+1):E(0))},150)},5e3)))},150);return()=>clearInterval(P)}},[u,w]),N("div",{className:"flex flex-col bg-base-100 rounded-2xl items-center mb-5 rounded-3xltransition duration-500 ease-in-out  transform  hover:scale-105 lg:hidden",style:{userSelect:"none"},children:[N("div",{className:"flex flex-col items-center justify-center",children:[g("img",{src:`${e?"https://op.yychuiyan.com/avatar1513.webp":"https://op.yychuiyan.com/avatar1511.webp"}`,alt:"",className:`image-container w-24 h-24 mt-3 rounded-full ${e?"rotate":""}`,onMouseEnter:()=>{r(!e)},onMouseLeave:()=>{r(e)}}),g("p",{className:"flex items-center justify-center w-64 h-5   pl-2 mt-3 overflow-clip",children:g("span",{className:"",children:k})})]}),N("div",{className:"flex justify-around w-64 h-20 pl-1 pt-2  rounded-xl overflow-clip",children:[N("p",{className:"flex flex-col items-center justify-center w-14 h-14 rounded-2xl cursor-pointer text-[var(--color-icon-default)] hover:bg-[var(--user-content-color)] hover:text-[var(--color-icon-default)] transform duration-300 ease-in",onClick:()=>{t("/timeline")},children:[g("span",{children:"文章"}),g("span",{className:"text-sm",children:j})]}),N("p",{className:"flex flex-col items-center justify-center w-14 h-14 rounded-2xl cursor-pointer text-[var(--color-icon-default)] hover:bg-[var(--user-content-color)] hover:text-[var(--color-icon-default)] transform duration-300 ease-in",onClick:()=>{t("/category")},children:[g("span",{children:"分类"}),g("span",{className:"text-sm",children:d})]}),N("p",{className:"flex flex-col items-center justify-center w-14 h-14 rounded-2xl cursor-pointer text-[var(--color-icon-default)] hover:bg-[var(--user-content-color)] hover:text-[var(--color-icon-default)] transform duration-300 ease-in",onClick:()=>{t("/tags")},children:[g("span",{children:"标签"}),g("span",{className:"text-sm",children:f})]})]})]})};export{Ne as A,be as U};
